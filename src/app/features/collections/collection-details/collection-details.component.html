<div class="p-8 max-w-[1200px] mx-auto">
  <div class="flex justify-between items-center mb-6 flex-wrap gap-4">
    <h1 class="m-0 text-3xl font-semibold">Collection Movies</h1>
  </div>

  @if (collections().length > 0) {
    <div class="mb-6">
      <mat-form-field appearance="outline" class="w-full md:w-64">
        <mat-label>Select Collection</mat-label>
        <mat-select
          [value]="selectedCollectionId()"
          (selectionChange)="onCollectionChange($event.value)"
        >
          @for (collection of collections(); track collection.id) {
            <mat-option [value]="collection.id">
              {{ collection.name }}
              <span class="text-gray-500 text-sm ml-2">
                ({{ collection.movies.length }}
                {{ collection.movies.length === 1 ? 'movie' : 'movies' }})
              </span>
            </mat-option>
          }
        </mat-select>
      </mat-form-field>
    </div>

    @if (getSelectedCollection(); as collection) {
      @if (collection.description) {
        <div class="mb-6 p-4 rounded-lg bg-white/5">
          <p class="m-0 text-sm">{{ collection.description }}</p>
        </div>
      }

      <app-movie-list
        [movies]="movies()"
        [isLoading]="false"
        [emptyMessage]="'No movies in this collection yet'"
        [selectedMovieIds]="selectedMovieIds()"
        (movieSelectionToggle)="onMovieSelectionToggle($event)"
      />
    }
  } @else {
    <div class="flex flex-col items-center justify-center py-16 px-8 text-center gap-2">
      <mat-icon class="mb-4" style="font-size: 80px; width: 80px; height: 80px"
        >folder_open</mat-icon
      >
      <h2 class="m-0 mb-2 text-2xl">No collections available</h2>
      <p class="m-0 mb-8 text-gray-600">Create a collection to get started!</p>
    </div>
  }
</div>

@if (selectedMovies().length > 0) {
  <button
    mat-fab
    (click)="removeSelectedMovies()"
    [matBadge]="selectedMovies().length"
    matBadgePosition="above before"
    matBadgeColor="accent"
    [attr.aria-label]="'Remove ' + selectedMovies().length + ' selected movies from collection'"
    style="position: fixed; bottom: 24px; right: 24px; z-index: 1000; background-color: rgb(255, 72, 72);"
  >
    <mat-icon>delete</mat-icon>
  </button>
}
